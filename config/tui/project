" Default values for optional project settings

"     Source for fzf
if !exists("g:nvim_ide_fzf_source")
    let g:nvim_ide_fzf_source = 'rg --files'
endif

"     Basic line for search in project files content using ripgrep
if !exists("g:nvim_ide_content_search_rg_basic_cmd")
    let g:nvim_ide_content_search_rg_basic_cmd = 'rg --vimgrep --smart-case'
endif


" Project configuration
"     Directory for extra files
let s:project_extra_files_dir = ''
function! NvimIdeGetProjectExtraFilesDir()
    if !exists("g:nvim_ide_project_root")
        return "/tmp"
    endif

    if s:project_extra_files_dir == ''
        let s:project_extra_files_dir = g:nvim_ide_project_root.'/.nvim_ide_project_extra'
        if !isdirectory(s:project_extra_files_dir)
            call mkdir(s:project_extra_files_dir)
        endif
    endif

    return s:project_extra_files_dir
endfunction

function! s:GetCompileCommandsPath()
    return g:nvim_ide_project_root .. "/compile_commands.json"
endfunction

function! s:RegenCompdb()
    call system("cd " .. g:nvim_ide_project_root .. "; " .. g:nvim_ide_cpp_compilation_database_command .. " > " .. s:GetCompileCommandsPath())
    echo "Compilation database has been regenerated!"
endfunction
command! NvimIdeRegenCompdb :call s:RegenCompdb()

if exists("g:nvim_ide_cpp_compilation_database_command")
    "     Num threads for C/C++ language server
    if !exists("g:nvim_ide_cpp_language_server_threads")
        let g:nvim_ide_cpp_language_server_threads = 4
    endif

    "     Gen compilation database
    if empty(glob(s:GetCompileCommandsPath()))
        call s:RegenCompdb()
    endif
endif

"     Build command for project (C/C++, go)
if exists("g:nvim_ide_build_command")
    let &makeprg=g:nvim_ide_build_command
endif

"     Settings for debugger
if !exists("g:nvim_ide_debuggee_binary_path")
    let g:nvim_ide_debuggee_binary_path = ''
endif

if !exists("g:nvim_ide_debuggee_binary_args")
    let g:nvim_ide_debuggee_binary_args = ''
endif

if !exists("g:nvim_ide_cpp_debugger_source_map")
    let g:nvim_ide_cpp_debugger_source_map = []
endif

"     Icons
if !exists("g:nvim_ide_allow_icons")
    let g:nvim_ide_allow_icons = v:false
endif

